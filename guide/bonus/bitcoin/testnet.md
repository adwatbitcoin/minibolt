---
layout: default
title: MiniBolt on Testnet
parent: + Bitcoin
grand_parent: Bonus Section
nav_exclude: true
has_children: false
has_toc: false
---
<!-- markdownlint-disable MD014 MD022 MD025 MD033 MD040 -->

# Bonus guide: MiniBolt on Testnet

{: .no_toc }

---

You can run your MiniBolt node on testnet to develop and experiment with new applications, without putting real money at risk. This bonus guide highlights all configuration changes compared to the main guide.

Difficulty: Medium
{: .label .label-yellow }

---

## Table of contents
{: .text-delta }

1. TOC
{:toc}

---

## Introduction

Running a testnet node is a great way to get acquainted with the MiniBolt and the suite of Bitcoin-related software typical of these powerful setups. Moreover, testnet empowers users to tinker with the software and its many configurations without the threat of losing funds. Helping bitcoiners run a full testnet setup is a goal worthy of the MiniBolt, and this page should provide you with the knowledge to get there.

The great news is that most of the MiniBolt guide can be used as-is. The small adjustments come in the form of changes to the config files and ports for testnet. You can follow the guide and simply replace the following configurations in the right places as you go.

## Bitcoin client

* Login with "admin", change to "bitcoin" user and replace "bitcoin.conf" with the next

  ```sh
  $ nano /home/bitcoin/.bitcoin/bitcoin.conf
  ```

  ```sh
  # MiniBolt: bitcoind configuration for testnet node
  # /home/bitcoin/.bitcoin/bitcoin.conf
  # Bitcoin daemon
  server=1
  txindex=1

  # Enable all compact filters
  blockfilterindex=1
  # Support filtering of blocks and transactions with bloom filters
  peerbloomfilters=1
  # Serve compact block filters to peers per BIP 157.
  peerblockfilters=1
  # Maintain coinstats index used by the gettxoutsetinfo RPC (commented slow device optimization)
  coinstatsindex=1

  # Testnet mode
  testnet=1
  startupnotify=chmod g+r /home/bitcoin/.bitcoin/testnet3/.cookie
  disablewallet=1

  # Enable and proxify Tor
  listenonion=1
  proxy=127.0.0.1:9050

  # Enable I2P
  i2pacceptincoming=1
  i2psam=127.0.0.1:7656

  # Connections
  rpcauth=<replace with your own auth line generated by rpcauth.py in the previous step>

  # Network
  listen=1
  listenonion=1
  proxy=127.0.0.1:9050

  # Initial block download optimizations
  dbcache=2048
  blocksonly=1
  ```

* Grant the "bitcoin" group read-permission for the debug log file:

  ```sh
  $2 sudo chmod g+r /data/bitcoin/testnet3/debug.log
  ```

* Return to the first session and monitor "bitcoind" by its log file. You can exit monitoring at any time with `Ctrl-C`

  ```sh
  $ sudo tail --lines 500 -f /home/bitcoin/.bitcoin/testnet3/debug.log
  ```

sudo su - bitcoin

bitcoin-cli -testnet

## Electrs

File location: `/data/electrs/electrs.conf`

```sh
# MiniBolt: electrs configuration for testnet node
# /data/electrs/electrs.conf

# Bitcoin Core settings
network = "testnet"
daemon_dir= "/data/bitcoin"
cookie_file = "/data/bitcoin/testnet3/.cookie"
daemon_rpc_addr = "127.0.0.1:18332"
daemon_p2p_addr = "127.0.0.1:18333"

# Electrs settings. If you chose to connect locally without Nginx reverse proxy,
# configure: `electrum_rpc_addr = "0.0.0.0:60001"` and configure FW accordingly (not recommended)
electrum_rpc_addr = "127.0.0.1:60001"
db_dir = "/data/electrs/db/"
server_banner = "Welcome to electrs (Electrum Rust Server) running on a MiniBolt node testnet!"

# Logging
log_filters = "INFO"
timestamp = true
```

Check the logs using

```sh
$ sudo journalctl -u electrs -f
```

### Nginx

File location: `/etc/nginx/streams-enabled/electrs-testnet-reverse-proxy.conf`

  ```sh
  upstream electrs {
    server 127.0.0.1:60001;
  }

  server {
    listen 60002 ssl;
    proxy_pass electrs;
  }
  ```

  ```sh
  $ sudo nginx -t
  ```

  ```sh
  $ sudo systemctl reload nginx
  ```

Firewall:

  ```sh
  $ sudo ufw allow from 192.168.0.0/16 to any port 60002 proto tcp comment 'allow Electrs SSL Testnet from local network'
  ```

### Tor

Create a separate service for testnet over Tor by adding the following lines in the `location-hidden services` section:

File location: `/etc/tor/torrc`

  ```sh
  ############### This section is just for location-hidden services ###
  # Hidden Service Electrs Testnet TCP
  HiddenServiceDir /var/lib/tor/hidden_service_electrs_testnet_tcp/
  HiddenServiceVersion 3
  HiddenServicePort 60001 127.0.0.1:60001

  # Hidden Service Electrs Testnet SSL
  HiddenServiceDir /var/lib/tor/hidden_service_electrs_testnet_ssl/
  HiddenServiceVersion 3
  HiddenServicePort 60002 127.0.0.1:60002
  ```

Once that's done, you'll need to start the service using:

  ```sh
  $ sudo systemctl reload tor
  ```

  ```sh
  $ sudo cat /var/lib/tor/hidden_service_electrs_testnet_tcp/hostname
  ```

  ```sh
  $ sudo cat /var/lib/tor/hidden_service_electrs_testnet_ssl/hostname
  ```

## Fulcrum

```sh
  $ nano /data/fulcrum/fulcrum.conf
  ```

  ```sh
  # MiniBolt: fulcrum configuration
  # /data/fulcrum/fulcrum.conf

  ## Bitcoin Core settings
  bitcoind = 127.0.0.1:18332
  rpccookie = /data/bitcoin/testnet3/.cookie

  ## Fulcrum server general settings
  datadir = /data/fulcrum/fulcrum_db
  cert = /data/fulcrum/cert.pem
  key = /data/fulcrum/key.pem
  ssl = 0.0.0.0:60002
  tcp = 0.0.0.0:60001
  peering = false

  # Set fast-sync accorling with your device,
  # recommended: fast-sync=1/2 x RAM available e.g: 4GB RAM -> dbcache=2048)
  fast-sync = 2048

  # Banner
  banner = /data/fulcrum/fulcrum-banner.txt
  ```

## LND

The following are the lines that need changing in the LND configuration file.

File location: `/data/lnd/lnd.conf`

  ```sh
  [Bitcoin]
  bitcoin.active=1
  bitcoin.testnet=1
  bitcoin.node=bitcoind
  ```

And the following command gives members of the group `lnd` permission to traverse the LND directories to reach the macaroons

  ```sh
  $ sudo chmod -R g+X /data/lnd/data/
  ```

### Interacting with the LND daemon

Note that when interacting with the LND daemon, you'll need to use the `--network testnet` option like so:

  ```sh
  $ lncli --network testnet walletbalance
  ```

---

<< Back: [+ Bitcoin](index.md)
